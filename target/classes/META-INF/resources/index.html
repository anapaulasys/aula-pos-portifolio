<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Portifolio</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
</head>
<body class="bg-light">

<div class="container p-lg-5">
    <div class="row justify-content-center bg-body rounded shadow p-3">
        <div class="col-4 text-center">
            <img src="https://cdn.pixabay.com/photo/2012/04/26/19/43/profile-42914_960_720.png"
                 class="img-thumbnail">
        </div>
        <div class="col-8">
            <div class="row text-end">
                <a type="button" data-bs-toggle="modal" data-bs-target="#edit-perfil-modal" onclick="editPerfil()">Editar</a>
            </div>
            <div class="row">
                <h2>
                    Olá meu nome é <strong id="perfil-nome"></strong>
                </h2>
                <p id="perfil-bio">

                </p>
            </div>
            <div class="row mt-5">
                <div class="col-6">
                    <h2 id="perfil-fone"></h2>
                    <p>Telefone</p>
                </div>
                <div class="col-6">
                    <h2 id="perfil-email"></h2>
                    <p>Email</p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="edit-perfil-modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                Edição do Perfil
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="edit-perfil-nome" class="form-label">Nome</label>
                    <input type="text" class="form-control" id="edit-perfil-nome">
                </div>
                <div class="mb-3">
                    <label for="edit-perfil-email"  class="form-label">Email</label>
                    <input type="email" class="form-control" id="edit-perfil-email" placeholder="seunome@gmail.com">
                </div>
                <div class="mb-3">
                    <label for="edit-perfil-fone" class="form-label">Telefone</label>
                    <input type="text" class="form-control" id="edit-perfil-fone">
                </div>
                <div class="mb-3">
                    <label for="edit-perfil-bio"  class="form-label">Biografia</label>
                    <textarea type="text" class="form-control" id="edit-perfil-bio" rows="3"></textarea>
                </div>

            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button class="btn btn-primary" onclick="savePerfil()" data-bs-dismiss="modal">Salvar</button>
            </div>
        </div>
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
        crossorigin="anonymous"></script>

<script type="application/javascript">

    var perfil = {};

    function getPerfil() {
        $.ajax({
            url: "http://localhost:8080/api/perfil",
            type: "GET",
            contentType: 'application/json',
            success: function (respose) {
                if(respose) {
                    perfil = respose;

                    $('#perfil-nome').html(respose.nome);
                    $('#perfil-fone').html(respose.telefone);
                    $('#perfil-email').html(respose.email);
                    $('#perfil-bio').html(respose.bio);
                }else{
                    perfil = {};
                }
            },
            error: function (error) {
                console.log(error);
            }
        });
    }

    function editPerfil() {
        $('#edit-perfil-nome').val(perfil.nome);
        $('#edit-perfil-email').val(perfil.email);
        $('#edit-perfil-fone').val(perfil.telefone);
        $('#edit-perfil-bio').val(perfil.bio);
    }

    function savePerfil() {
        perfil.nome = $('#edit-perfil-nome').val()
        perfil.email = $('#edit-perfil-email').val()
        perfil.telefone = $('#edit-perfil-fone').val()
        perfil.bio = $('#edit-perfil-bio').val()

        $.ajax({
            url: "http://localhost:8080/api/perfil",
            type: "POST",
            contentType: 'application/json',
            data: JSON.stringify(perfil),
            success: getPerfil,
            error: function (error) {
                console.log(error);
            }
        });
    }

    $(document).ready(function () {
        getPerfil();
    });

</script>


</body>
</html>